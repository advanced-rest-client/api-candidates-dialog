<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">
    <title>api-request-editor demo</title>

    <script src="../../../@webcomponents/webcomponentsjs/webcomponents-loader.js"></script>
    <script src="../../../web-animations-js/web-animations-next.min.js"></script>

    <script type="module">
      import '@polymer/iron-demo-helpers/demo-pages-shared-styles.js';
      import '@polymer/polymer/lib/elements/dom-bind.js';
      import '@polymer/paper-button/paper-button.js';
      import '@polymer/neon-animation/animations/slide-up-animation.js';
      import '@polymer/neon-animation/animations/slide-from-top-animation.js';
      import '../api-candidates-dialog.js';
    </script>
    <custom-style>
      <style is="custom-style" include="demo-pages-shared-styles">
      </style>
    </custom-style>
    <script src="../../../chance/chance.js"></script>
  </head>
  <body>
    <dom-bind id="demo">
      <template is="dom-bind">
        <div class="vertical-section-container centered" role="main">
          <api-candidates-dialog candidates="[[candidates]]" entry-animation="slide-from-top-animation" exit-animation="slide-up-animation"></api-candidates-dialog>
          <paper-button on-click="_openDialogEvent">Open dialog</paper-button>
        </div>

        <output>
          <p>Selected: [[selected]]</p>
        </output>
      </template>
    </dom-bind>
    <script type="module">
    /* global chance */
    (function(app) {
      app.genList = () => {
        const list = [];
        for (let i = 0; i < 5; i++) {
          list.push(chance.word());
        }
        return list;
      };
      app._load = function() {
        app.candidates = app.genList();
      };

      app._openDialog = () => {
        document.body.querySelector('api-candidates-dialog').opened = true;
      };

      app._openDialogEvent = () => {
        const e = new CustomEvent('api-select-entrypoint', {
          bubbles: true,
          cancelable: true,
          detail: {
            candidates: app.genList()
          }
        });
        document.body.dispatchEvent(e);
        e.detail.result
        .then((file) => {
          app.selected = file;
        })
        .catch((cause) => {
          app.selected = '';
          console.log(cause);
        });
      };
      window.addEventListener('WebComponentsReady', () => app._load());
    })(document.getElementById('demo'));
    </script>
  </body>
</html>
